//---------------------------------------------------------------------------

#pragma hdrstop

#include "Programm.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;
Cart cart(100, 400, 100, 450, 10, clGray);
Cargo cargo(150, 340, 180, 350, clYellow);
bool filled;
int i = 0, vertical, k = 1, speed = 60, x1 = cart.x1, x2;



__fastcall TForm1::TForm1(TComponent* Owner)
	: TForm(Owner)
{
	Image->Canvas->Pen->Color=clWhite;
}

void __fastcall TForm1::Button1Click(TObject *Sender)
{
	cart.show(Image->Canvas);
	Button2->Visible = true;
}

void __fastcall TForm1::Button2Click(TObject *Sender)
{
	CargoTimer->Enabled = true;
}

void __fastcall TForm1::Button3Click(TObject *Sender)
{
	k *= -1;
}

void __fastcall TForm1::Button4Click(TObject *Sender)
{
	Timer->Interval = 30 / SpeedScrollBar->Position;
	Timer->Enabled = !Timer->Enabled;
	if(Timer->Enabled)
	{
		Button4->Caption = "Stop the cart";
	}
	else
	{
		Button4->Caption = "Push the cart";
	}
}

void __fastcall TForm1::TimerTimer(TObject *Sender)
{
	cart.hide(Image->Canvas);
	cart.move(Canvas, k * speed, 0, k * speed, 0);
	cart.show(Image->Canvas);
	x2 = x1;
	x1 = cart.x1;
	cargo.hide(Image->Canvas);
	cargo.move(Canvas, k * abs(x1 - x2), 0, k * abs(x1 - x2), 0);
	cargo.show(Image->Canvas);
}

void __fastcall TForm1::CargoTimerTimer(TObject *Sender)
{
	i++;
	cargo.hide(Image->Canvas);
	cargo.move(Canvas, 0, 1, 0, 1);
	cargo.show(Image->Canvas);
	if(i == 50)
	{
		CargoTimer->Enabled = false;
        Button3->Visible = true;
		Button4->Visible = true;
		SpeedScrollBar->Visible = true;
        SpeedText->Visible = true;
    }
}

void __fastcall TForm1::SpeedScrollBarChange(TObject *Sender)
{
	Timer->Interval = 30 / SpeedScrollBar->Position;
}

