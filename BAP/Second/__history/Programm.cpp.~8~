//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Programm.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;
int sze = 0, capacity = 10;
Tool* shelf = (Tool*)malloc(20*sizeof*shelf);
Tool curtool;
int i;

__fastcall TForm1::TForm1(TComponent* Owner)
	: TForm(Owner)
{

}

void push(Tool tool)
{
	if(sze > capacity)
	{
		realloc(shelf, capacity * sizeof(class Tool));
		capacity *= 2;
	}
	shelf[i++] = tool;
}

void __fastcall TForm1::AddClick(TObject *Sender)
{
	wchar_t* temp;
	GroupName->GetTextBuf(curtool.groupName, GroupName->GetTextLen());
	Name->GetTextBuf(curtool.name, Name->GetTextLen());
	Color->GetTextBuf(curtool.color, Color->GetTextLen());
	curtool.available = Available->Text.ToInt();
    curtool.sold = Sold->Text.ToInt();
	if(Delivery->Text == "Yes")
	{
		curtool.delivery = true;
	}
	else
	{
		curtool.delivery = false;
	}
	shelf.push(curtool);
}

void __fastcall TForm1::LoadClick(TObject *Sender)
{
	int i = 2;
	Memo->Lines->LoadFromFile("Shelf.txt");
	while(Memo->Lines->Strings[i] != "")
	{
		int j = 0;
		UnicodeString str = Memo->Lines->Strings[i];
		while(str[j] != ' ')
		{
			curtool.groupName += str[j];
			j++;
		}
		while(str[j] == ' ')
		{
			j++;
		}
		while(str[j] != ' ')
		{
			curtool.name += str[j];
			j++;
		}
		while(str[j] == ' ')
		{
			j++;
		}
		while(str[j] != ' ')
		{
			curtool.available *= 10;
			curtool.available += str[j] - '0';
			j++;
		}
		while(str[j] == ' ')
		{
			j++;
		}
		while(str[j] != ' ')
		{
			curtool.sold *= 10;
			curtool.sold += str[j] - '0';
			j++;
		}
		while(str[j] == ' ')
		{
			j++;
		}
        while(str[j] != ' ')
		{
			curtool.color += str[j];
			j++;
		}
		while(str[j] == ' ')
		{
			j++;
		}
		string stryes;
		while(str[j] != '\n')
		{
			stryes += str[j];
		}
		if(stryes == "Yes")
		{
			curtool.delivery = true;
		}
		else
		{
			curtool.delivery = false;
		}

		i++;
	}
}

void __fastcall TForm1::SaveClick(TObject *Sender)
{
	Memo->Lines->SaveToFile("Shelf.txt");
}






void printTool(Tool curtool)
{
	//Memo->Lines->Add(curtool.groupName>>curtool.nameext>>curtool.available<<" - - "<<curtool.sold<<" - - "<<curtool.color<<" - - "<<curtool.delivery);
}

